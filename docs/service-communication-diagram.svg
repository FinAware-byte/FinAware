<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 3000 2600" font-family="'Segoe UI', 'Helvetica Neue', Arial, sans-serif">
  <defs>
    <linearGradient id="bgG" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f8fafc"/>
      <stop offset="100%" style="stop-color:#e2e8f0"/>
    </linearGradient>
    <linearGradient id="webGr" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#3b82f6"/>
      <stop offset="100%" style="stop-color:#1d4ed8"/>
    </linearGradient>
    <linearGradient id="sA" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#fef3c7"/><stop offset="100%" style="stop-color:#fde68a"/></linearGradient>
    <linearGradient id="sD" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#dbeafe"/><stop offset="100%" style="stop-color:#bfdbfe"/></linearGradient>
    <linearGradient id="sI" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#dcfce7"/><stop offset="100%" style="stop-color:#bbf7d0"/></linearGradient>
    <linearGradient id="sDe" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#fce7f3"/><stop offset="100%" style="stop-color:#fbcfe8"/></linearGradient>
    <linearGradient id="sR" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#ede9fe"/><stop offset="100%" style="stop-color:#ddd6fe"/></linearGradient>
    <linearGradient id="sH" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#ccfbf1"/><stop offset="100%" style="stop-color:#99f6e4"/></linearGradient>
    <linearGradient id="sP" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#fed7aa"/><stop offset="100%" style="stop-color:#fdba74"/></linearGradient>
    <linearGradient id="dbGr" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#fecaca"/><stop offset="100%" style="stop-color:#fca5a5"/></linearGradient>
    <linearGradient id="exGr" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#e9d5ff"/><stop offset="100%" style="stop-color:#c4b5fd"/></linearGradient>
    <linearGradient id="prGr" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#f1f5f9"/><stop offset="100%" style="stop-color:#e2e8f0"/></linearGradient>
    <filter id="s" x="-2%" y="-2%" width="104%" height="108%"><feDropShadow dx="0" dy="4" stdDeviation="5" flood-opacity="0.15"/></filter>
    <filter id="sl" x="-2%" y="-2%" width="104%" height="106%"><feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.1"/></filter>
    <marker id="ar" viewBox="0 0 10 10" refX="10" refY="5" markerWidth="10" markerHeight="10" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10" fill="#64748b"/></marker>
    <marker id="arB" viewBox="0 0 10 10" refX="10" refY="5" markerWidth="10" markerHeight="10" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10" fill="#3b82f6"/></marker>
  </defs>

  <rect width="3000" height="2600" fill="url(#bgG)" rx="16"/>

  <!-- Title -->
  <text x="1500" y="65" text-anchor="middle" font-size="48" font-weight="700" fill="#1e293b">FinAware — Service Communication Diagram</text>
  <text x="1500" y="110" text-anchor="middle" font-size="22" fill="#64748b">Frontend → Proxy → Microservices → Database &amp; External APIs</text>

  <!-- ═══════════ BROWSER ═══════════ -->
  <rect x="850" y="145" width="1300" height="100" rx="14" fill="#fff" stroke="#94a3b8" stroke-width="2" filter="url(#s)"/>
  <text x="1500" y="190" text-anchor="middle" font-size="28" font-weight="700" fill="#334155">Client Browser</text>
  <text x="1500" y="225" text-anchor="middle" font-size="18" fill="#64748b">React 18 + Tailwind CSS + Recharts | httpOnly Session Cookies</text>

  <line x1="1500" y1="245" x2="1500" y2="295" stroke="#3b82f6" stroke-width="3" marker-end="url(#arB)"/>
  <text x="1535" y="278" font-size="16" font-weight="500" fill="#3b82f6">HTTP/SSR</text>

  <!-- ═══════════ NEXT.JS ═══════════ -->
  <rect x="350" y="300" width="2300" height="310" rx="14" fill="url(#webGr)" fill-opacity="0.08" stroke="#3b82f6" stroke-width="2.5" filter="url(#s)"/>
  <text x="390" y="340" font-size="26" font-weight="700" fill="#1e40af">Next.js 14 — Web Server (Port 30005)</text>

  <!-- Middleware -->
  <rect x="400" y="360" width="500" height="90" rx="10" fill="#fff" stroke="#3b82f6" stroke-width="1.5" filter="url(#sl)"/>
  <text x="650" y="398" text-anchor="middle" font-size="20" font-weight="600" fill="#1e40af">Middleware</text>
  <text x="650" y="425" text-anchor="middle" font-size="15" fill="#64748b">Route protection | Auth + FICA guards</text>

  <!-- API Routes -->
  <rect x="950" y="360" width="600" height="90" rx="10" fill="#fff" stroke="#3b82f6" stroke-width="1.5" filter="url(#sl)"/>
  <text x="1250" y="398" text-anchor="middle" font-size="20" font-weight="600" fill="#1e40af">API Route Handlers</text>
  <text x="1250" y="425" text-anchor="middle" font-size="15" fill="#64748b">/api/microservices/* | /api/ai-recommendations | /api/pdf</text>

  <!-- SSR -->
  <rect x="1600" y="360" width="500" height="90" rx="10" fill="#fff" stroke="#3b82f6" stroke-width="1.5" filter="url(#sl)"/>
  <text x="1850" y="398" text-anchor="middle" font-size="20" font-weight="600" fill="#1e40af">Server Components (SSR)</text>
  <text x="1850" y="425" text-anchor="middle" font-size="15" fill="#64748b">Dashboard, Identity, Debts, Rehab, Help</text>

  <!-- Proxy -->
  <rect x="600" y="480" width="1200" height="80" rx="10" fill="url(#prGr)" stroke="#64748b" stroke-width="2" filter="url(#sl)"/>
  <text x="1200" y="516" text-anchor="middle" font-size="22" font-weight="700" fill="#334155">Service Proxy (lib/microservices/proxy.ts)</text>
  <text x="1200" y="545" text-anchor="middle" font-size="16" fill="#64748b">callService() / callServiceJson() — HTTP fetch to localhost:41xx | ENV-based service discovery</text>

  <!-- Connection lines from proxy to services -->
  <line x1="750" y1="560" x2="260" y2="680" stroke="#b45309" stroke-width="2" stroke-dasharray="8,4"/>
  <line x1="900" y1="560" x2="660" y2="680" stroke="#2563eb" stroke-width="2" stroke-dasharray="8,4"/>
  <line x1="1050" y1="560" x2="1060" y2="680" stroke="#16a34a" stroke-width="2" stroke-dasharray="8,4"/>
  <line x1="1200" y1="560" x2="1460" y2="680" stroke="#db2777" stroke-width="2" stroke-dasharray="8,4"/>
  <line x1="1350" y1="560" x2="1860" y2="680" stroke="#7c3aed" stroke-width="2" stroke-dasharray="8,4"/>
  <line x1="1500" y1="560" x2="2260" y2="680" stroke="#0d9488" stroke-width="2" stroke-dasharray="8,4"/>
  <line x1="1650" y1="560" x2="2660" y2="680" stroke="#ea580c" stroke-width="2" stroke-dasharray="8,4"/>

  <!-- ═══════════ SERVICES ═══════════ -->
  <text x="1500" y="660" text-anchor="middle" font-size="24" font-weight="700" fill="#475569">MICROSERVICES (Independent Express Processes)</text>

  <!-- Auth -->
  <rect x="80" y="680" width="360" height="350" rx="12" fill="url(#sA)" stroke="#d97706" stroke-width="2" filter="url(#s)"/>
  <rect x="80" y="680" width="360" height="50" rx="12" fill="#fbbf24" fill-opacity="0.5"/>
  <text x="260" y="712" text-anchor="middle" font-size="22" font-weight="700" fill="#92400e">Auth Service</text>
  <text x="260" y="750" text-anchor="middle" font-size="18" font-weight="600" fill="#78350f">Port 4101</text>
  <line x1="95" y1="762" x2="425" y2="762" stroke="#d4a500" stroke-width="1"/>
  <text x="105" y="790" font-size="16" fill="#374151">POST /auth/login</text>
  <text x="105" y="815" font-size="16" fill="#374151">GET  /auth/users/:id</text>
  <text x="105" y="840" font-size="16" fill="#374151">POST /auth/fica/verify</text>
  <line x1="95" y1="855" x2="425" y2="855" stroke="#d4a500" stroke-width="1"/>
  <text x="105" y="885" font-size="14" fill="#6b7280">loginOrCreateUser()</text>
  <text x="105" y="910" font-size="14" fill="#6b7280">Profile Generation + Risk Assignment</text>
  <text x="105" y="935" font-size="14" fill="#6b7280">SA ID / Passport Validation</text>
  <line x1="95" y1="950" x2="425" y2="950" stroke="#d4a500" stroke-width="1"/>
  <text x="105" y="975" font-size="14" font-weight="600" fill="#b45309">W: Users, CreditProfile, Debts</text>
  <text x="105" y="998" font-size="14" font-weight="600" fill="#b45309">   PaymentHistory, LegalRecords</text>
  <text x="105" y="1021" font-size="14" font-weight="600" fill="#2563eb">R: Users</text>

  <!-- Dashboard -->
  <rect x="480" y="680" width="360" height="350" rx="12" fill="url(#sD)" stroke="#2563eb" stroke-width="2" filter="url(#s)"/>
  <rect x="480" y="680" width="360" height="50" rx="12" fill="#93c5fd" fill-opacity="0.5"/>
  <text x="660" y="712" text-anchor="middle" font-size="22" font-weight="700" fill="#1e40af">Dashboard Svc</text>
  <text x="660" y="750" text-anchor="middle" font-size="18" font-weight="600" fill="#1e3a5f">Port 4102</text>
  <line x1="495" y1="762" x2="825" y2="762" stroke="#60a5fa" stroke-width="1"/>
  <text x="500" y="790" font-size="16" fill="#374151">GET /dashboard/</text>
  <text x="500" y="815" font-size="16" fill="#374151">    overview/:userId</text>
  <line x1="495" y1="830" x2="825" y2="830" stroke="#60a5fa" stroke-width="1"/>
  <text x="500" y="858" font-size="14" fill="#6b7280">calculateDashboardMetrics()</text>
  <text x="500" y="883" font-size="14" fill="#6b7280">getFinancialAgeDetails()</text>
  <text x="500" y="908" font-size="14" fill="#6b7280">getRiskFactors()</text>
  <text x="500" y="933" font-size="14" fill="#6b7280">buildScoreProjection()</text>
  <text x="500" y="958" font-size="14" fill="#6b7280">Debt Composition Map</text>
  <line x1="495" y1="972" x2="825" y2="972" stroke="#60a5fa" stroke-width="1"/>
  <text x="500" y="998" font-size="14" font-weight="600" fill="#2563eb">R: Users, Debts</text>

  <!-- Identity -->
  <rect x="880" y="680" width="360" height="350" rx="12" fill="url(#sI)" stroke="#16a34a" stroke-width="2" filter="url(#s)"/>
  <rect x="880" y="680" width="360" height="50" rx="12" fill="#86efac" fill-opacity="0.5"/>
  <text x="1060" y="712" text-anchor="middle" font-size="22" font-weight="700" fill="#166534">Identity Svc</text>
  <text x="1060" y="750" text-anchor="middle" font-size="18" font-weight="600" fill="#14532d">Port 4103</text>
  <line x1="895" y1="762" x2="1225" y2="762" stroke="#4ade80" stroke-width="1"/>
  <text x="900" y="790" font-size="16" fill="#374151">GET  /identity/profile/:id</text>
  <text x="900" y="815" font-size="16" fill="#374151">PATCH /identity/profile/:id</text>
  <line x1="895" y1="830" x2="1225" y2="830" stroke="#4ade80" stroke-width="1"/>
  <text x="900" y="858" font-size="14" fill="#6b7280">Profile read/update</text>
  <text x="900" y="883" font-size="14" fill="#6b7280">Download password hash</text>
  <text x="900" y="908" font-size="14" fill="#6b7280">Immutable ID fields</text>
  <text x="900" y="933" font-size="14" fill="#6b7280">identityUpdateSchema</text>
  <line x1="895" y1="950" x2="1225" y2="950" stroke="#4ade80" stroke-width="1"/>
  <text x="900" y="978" font-size="14" font-weight="600" fill="#16a34a">R/W: Users</text>

  <!-- Debts -->
  <rect x="1280" y="680" width="360" height="350" rx="12" fill="url(#sDe)" stroke="#db2777" stroke-width="2" filter="url(#s)"/>
  <rect x="1280" y="680" width="360" height="50" rx="12" fill="#f9a8d4" fill-opacity="0.5"/>
  <text x="1460" y="712" text-anchor="middle" font-size="22" font-weight="700" fill="#9d174d">Debts Service</text>
  <text x="1460" y="750" text-anchor="middle" font-size="18" font-weight="600" fill="#831843">Port 4104</text>
  <line x1="1295" y1="762" x2="1625" y2="762" stroke="#f472b6" stroke-width="1"/>
  <text x="1300" y="790" font-size="16" fill="#374151">GET   /debts/:userId</text>
  <text x="1300" y="815" font-size="16" fill="#374151">POST  /debts/:userId</text>
  <text x="1300" y="840" font-size="16" fill="#374151">PATCH /debts/:id</text>
  <line x1="1295" y1="855" x2="1625" y2="855" stroke="#f472b6" stroke-width="1"/>
  <text x="1300" y="883" font-size="14" fill="#6b7280">refreshCreditProfileTotals()</text>
  <text x="1300" y="908" font-size="14" fill="#6b7280">LegalRecord on GARNISHED</text>
  <text x="1300" y="933" font-size="14" fill="#6b7280">No delete endpoint</text>
  <line x1="1295" y1="950" x2="1625" y2="950" stroke="#f472b6" stroke-width="1"/>
  <text x="1300" y="978" font-size="14" font-weight="600" fill="#db2777">R/W: Debts, CreditProfile</text>
  <text x="1300" y="1001" font-size="14" font-weight="600" fill="#db2777">LegalRecords, PaymentHistory</text>

  <!-- Rehab -->
  <rect x="1680" y="680" width="360" height="350" rx="12" fill="url(#sR)" stroke="#7c3aed" stroke-width="2" filter="url(#s)"/>
  <rect x="1680" y="680" width="360" height="50" rx="12" fill="#c4b5fd" fill-opacity="0.5"/>
  <text x="1860" y="712" text-anchor="middle" font-size="22" font-weight="700" fill="#5b21b6">Rehab Service</text>
  <text x="1860" y="750" text-anchor="middle" font-size="18" font-weight="600" fill="#4c1d95">Port 4105</text>
  <line x1="1695" y1="762" x2="2025" y2="762" stroke="#a78bfa" stroke-width="1"/>
  <text x="1700" y="790" font-size="16" fill="#374151">POST /rehab/plan/:userId</text>
  <line x1="1695" y1="805" x2="2025" y2="805" stroke="#a78bfa" stroke-width="1"/>
  <text x="1700" y="833" font-size="14" fill="#6b7280">Strategy by risk level</text>
  <text x="1700" y="858" font-size="14" fill="#6b7280">HIGH → Urgent Intervention</text>
  <text x="1700" y="883" font-size="14" fill="#6b7280">MED → Stabilize &amp; Repair</text>
  <text x="1700" y="908" font-size="14" fill="#6b7280">LOW → Maintenance &amp; Growth</text>
  <text x="1700" y="933" font-size="14" fill="#6b7280">AI 4-week plan + fallback</text>
  <line x1="1695" y1="950" x2="2025" y2="950" stroke="#a78bfa" stroke-width="1"/>
  <text x="1700" y="978" font-size="14" font-weight="600" fill="#7c3aed">R: Users, Debts</text>
  <text x="1700" y="1001" font-size="14" font-weight="600" fill="#7c3aed">W: AiRecommendations</text>

  <!-- Help -->
  <rect x="2080" y="680" width="360" height="280" rx="12" fill="url(#sH)" stroke="#0d9488" stroke-width="2" filter="url(#s)"/>
  <rect x="2080" y="680" width="360" height="50" rx="12" fill="#5eead4" fill-opacity="0.5"/>
  <text x="2260" y="712" text-anchor="middle" font-size="22" font-weight="700" fill="#115e59">Help Service</text>
  <text x="2260" y="750" text-anchor="middle" font-size="18" font-weight="600" fill="#134e4a">Port 4106</text>
  <line x1="2095" y1="762" x2="2425" y2="762" stroke="#2dd4bf" stroke-width="1"/>
  <text x="2100" y="790" font-size="16" fill="#374151">GET  /help/requests/:id</text>
  <text x="2100" y="815" font-size="16" fill="#374151">POST /help/requests/:id</text>
  <line x1="2095" y1="830" x2="2425" y2="830" stroke="#2dd4bf" stroke-width="1"/>
  <text x="2100" y="858" font-size="14" fill="#6b7280">Consultation Requests</text>
  <text x="2100" y="883" font-size="14" fill="#6b7280">WhatsApp click-to-chat</text>
  <text x="2100" y="908" font-size="14" fill="#6b7280">Provider Lookup</text>
  <line x1="2095" y1="922" x2="2425" y2="922" stroke="#2dd4bf" stroke-width="1"/>
  <text x="2100" y="950" font-size="14" font-weight="600" fill="#0d9488">R/W: ExpertRequests, Providers</text>

  <!-- PDF -->
  <rect x="2480" y="680" width="360" height="280" rx="12" fill="url(#sP)" stroke="#ea580c" stroke-width="2" filter="url(#s)"/>
  <rect x="2480" y="680" width="360" height="50" rx="12" fill="#fdba74" fill-opacity="0.5"/>
  <text x="2660" y="712" text-anchor="middle" font-size="22" font-weight="700" fill="#9a3412">PDF Service</text>
  <text x="2660" y="750" text-anchor="middle" font-size="18" font-weight="600" fill="#7c2d12">Port 4107</text>
  <line x1="2495" y1="762" x2="2825" y2="762" stroke="#fb923c" stroke-width="1"/>
  <text x="2500" y="790" font-size="16" fill="#374151">POST /pdf/overview/:id</text>
  <line x1="2495" y1="805" x2="2825" y2="805" stroke="#fb923c" stroke-width="1"/>
  <text x="2500" y="833" font-size="14" fill="#6b7280">Password gate + Watermark</text>
  <text x="2500" y="858" font-size="14" fill="#6b7280">pdf-lib generation</text>
  <text x="2500" y="883" font-size="14" fill="#6b7280">Protected PDF export</text>
  <line x1="2495" y1="900" x2="2825" y2="900" stroke="#fb923c" stroke-width="1"/>
  <text x="2500" y="928" font-size="14" font-weight="600" fill="#ea580c">R: Users, CreditProfile, Debts</text>

  <!-- ═══════════ DATABASE ═══════════ -->
  <text x="1500" y="1090" text-anchor="middle" font-size="24" font-weight="700" fill="#475569">SHARED DATA LAYER</text>

  <!-- DB connections -->
  <line x1="260" y1="1030" x2="500" y2="1150" stroke="#b45309" stroke-width="2" stroke-dasharray="6,4"/>
  <line x1="660" y1="1030" x2="700" y2="1150" stroke="#2563eb" stroke-width="2" stroke-dasharray="6,4"/>
  <line x1="1060" y1="1030" x2="950" y2="1150" stroke="#16a34a" stroke-width="2" stroke-dasharray="6,4"/>
  <line x1="1460" y1="1030" x2="1200" y2="1150" stroke="#db2777" stroke-width="2" stroke-dasharray="6,4"/>
  <line x1="1860" y1="1030" x2="1350" y2="1150" stroke="#7c3aed" stroke-width="2" stroke-dasharray="6,4"/>
  <line x1="2260" y1="960" x2="800" y2="1300" stroke="#0d9488" stroke-width="2" stroke-dasharray="6,4"/>
  <line x1="2660" y1="960" x2="1350" y2="1200" stroke="#ea580c" stroke-width="2" stroke-dasharray="6,4"/>

  <rect x="280" y="1115" width="1300" height="440" rx="14" fill="url(#dbGr)" fill-opacity="0.3" stroke="#ef4444" stroke-width="2.5" filter="url(#s)"/>
  <text x="930" y="1155" text-anchor="middle" font-size="28" font-weight="700" fill="#991b1b">Prisma ORM + SQLite Database</text>
  <text x="930" y="1185" text-anchor="middle" font-size="16" fill="#dc2626">All 7 services share a single SQLite database via Prisma client</text>

  <!-- Tables -->
  <rect x="310" y="1210" width="270" height="80" rx="8" fill="#fff" stroke="#ef4444" stroke-width="1.2" filter="url(#sl)"/>
  <text x="445" y="1242" text-anchor="middle" font-size="19" font-weight="600" fill="#991b1b">Users</text>
  <text x="445" y="1270" text-anchor="middle" font-size="13" fill="#6b7280">Identity, Income, Risk, FICA</text>

  <rect x="610" y="1210" width="270" height="80" rx="8" fill="#fff" stroke="#ef4444" stroke-width="1.2" filter="url(#sl)"/>
  <text x="745" y="1242" text-anchor="middle" font-size="19" font-weight="600" fill="#991b1b">CreditProfile</text>
  <text x="745" y="1270" text-anchor="middle" font-size="13" fill="#6b7280">Score, Total Debt, Obligations</text>

  <rect x="910" y="1210" width="270" height="80" rx="8" fill="#fff" stroke="#ef4444" stroke-width="1.2" filter="url(#sl)"/>
  <text x="1045" y="1242" text-anchor="middle" font-size="19" font-weight="600" fill="#991b1b">Debts</text>
  <text x="1045" y="1270" text-anchor="middle" font-size="13" fill="#6b7280">Creditor, Balance, Status</text>

  <rect x="1210" y="1210" width="270" height="80" rx="8" fill="#fff" stroke="#ef4444" stroke-width="1.2" filter="url(#sl)"/>
  <text x="1345" y="1242" text-anchor="middle" font-size="19" font-weight="600" fill="#991b1b">PaymentHistory</text>
  <text x="1345" y="1270" text-anchor="middle" font-size="13" fill="#6b7280">Due Date, Paid, Missed</text>

  <rect x="310" y="1310" width="270" height="80" rx="8" fill="#fff" stroke="#ef4444" stroke-width="1.2" filter="url(#sl)"/>
  <text x="445" y="1342" text-anchor="middle" font-size="19" font-weight="600" fill="#991b1b">LegalRecords</text>
  <text x="445" y="1370" text-anchor="middle" font-size="13" fill="#6b7280">Judgments, Garnishee Orders</text>

  <rect x="610" y="1310" width="270" height="80" rx="8" fill="#fff" stroke="#ef4444" stroke-width="1.2" filter="url(#sl)"/>
  <text x="745" y="1342" text-anchor="middle" font-size="19" font-weight="600" fill="#991b1b">ExpertRequests</text>
  <text x="745" y="1370" text-anchor="middle" font-size="13" fill="#6b7280">Consultations Log</text>

  <rect x="910" y="1310" width="270" height="80" rx="8" fill="#fff" stroke="#ef4444" stroke-width="1.2" filter="url(#sl)"/>
  <text x="1045" y="1342" text-anchor="middle" font-size="19" font-weight="600" fill="#991b1b">AiRecommendations</text>
  <text x="1045" y="1370" text-anchor="middle" font-size="13" fill="#6b7280">Risk Level, JSON Snapshots</text>

  <rect x="1210" y="1310" width="270" height="80" rx="8" fill="#fff" stroke="#ef4444" stroke-width="1.2" filter="url(#sl)"/>
  <text x="1345" y="1342" text-anchor="middle" font-size="19" font-weight="600" fill="#991b1b">Providers</text>
  <text x="1345" y="1370" text-anchor="middle" font-size="13" fill="#6b7280">WhatsApp Numbers</text>

  <!-- Relationships -->
  <text x="930" y="1440" text-anchor="middle" font-size="16" font-weight="600" fill="#991b1b">Users 1→* Debts | Users 1→1 CreditProfile | Users 1→* LegalRecords | Debts 1→* PaymentHistory</text>
  <text x="930" y="1468" text-anchor="middle" font-size="16" font-weight="600" fill="#991b1b">Users 1→* ExpertRequests | Users 1→* WealthAssets</text>

  <!-- External -->
  <rect x="1700" y="1115" width="1140" height="440" rx="14" fill="url(#exGr)" fill-opacity="0.3" stroke="#7c3aed" stroke-width="2.5" filter="url(#s)"/>
  <text x="2270" y="1155" text-anchor="middle" font-size="28" font-weight="700" fill="#5b21b6">External Services</text>

  <rect x="1730" y="1200" width="510" height="110" rx="10" fill="#fff" stroke="#7c3aed" stroke-width="1.5" filter="url(#sl)"/>
  <text x="1985" y="1238" text-anchor="middle" font-size="20" font-weight="700" fill="#5b21b6">OpenAI API</text>
  <text x="1985" y="1266" text-anchor="middle" font-size="15" fill="#6b7280">Model: gpt-4.1-mini | Structured JSON Schema</text>
  <text x="1985" y="1290" text-anchor="middle" font-size="15" fill="#7c3aed">Used by: Rehab Service, Dashboard (AI recs)</text>

  <rect x="2280" y="1200" width="510" height="110" rx="10" fill="#fff" stroke="#0d9488" stroke-width="1.5" filter="url(#sl)"/>
  <text x="2535" y="1238" text-anchor="middle" font-size="20" font-weight="700" fill="#115e59">WhatsApp</text>
  <text x="2535" y="1266" text-anchor="middle" font-size="15" fill="#6b7280">Click-to-chat (wa.me) external redirect</text>
  <text x="2535" y="1290" text-anchor="middle" font-size="15" fill="#0d9488">Used by: Help Service</text>

  <rect x="1730" y="1340" width="510" height="90" rx="10" fill="#fff" stroke="#ea580c" stroke-width="1.5" filter="url(#sl)"/>
  <text x="1985" y="1378" text-anchor="middle" font-size="20" font-weight="700" fill="#9a3412">pdf-lib</text>
  <text x="1985" y="1406" text-anchor="middle" font-size="15" fill="#6b7280">PDF generation + watermark overlay</text>
  <text x="1985" y="1424" text-anchor="middle" font-size="15" fill="#ea580c">Used by: PDF Service</text>

  <rect x="2280" y="1340" width="510" height="90" rx="10" fill="#fff" stroke="#b45309" stroke-width="1.5" filter="url(#sl)"/>
  <text x="2535" y="1378" text-anchor="middle" font-size="20" font-weight="700" fill="#92400e">Risk Simulation Engine</text>
  <text x="2535" y="1406" text-anchor="middle" font-size="15" fill="#6b7280">ID suffix → Risk Level → Profile generation</text>
  <text x="2535" y="1424" text-anchor="middle" font-size="15" fill="#b45309">Used by: Auth Service</text>

  <!-- ═══════════ DEPLOYMENT ═══════════ -->
  <rect x="80" y="1610" width="2840" height="400" rx="14" fill="#fff" fill-opacity="0.5" stroke="#94a3b8" stroke-width="2" filter="url(#s)"/>
  <text x="120" y="1650" font-size="26" font-weight="700" fill="#334155">DEPLOYMENT TOPOLOGY</text>

  <!-- Docker -->
  <rect x="110" y="1680" width="850" height="290" rx="12" fill="#e0f2fe" stroke="#0284c7" stroke-width="2" filter="url(#sl)"/>
  <text x="535" y="1715" text-anchor="middle" font-size="22" font-weight="700" fill="#0369a1">Docker Compose (Local / CI)</text>
  <rect x="140" y="1735" width="150" height="45" rx="6" fill="#fff" stroke="#0284c7" stroke-width="1"/>
  <text x="215" y="1764" text-anchor="middle" font-size="14" font-weight="600" fill="#0369a1">web:30005</text>
  <rect x="310" y="1735" width="150" height="45" rx="6" fill="#fff" stroke="#0284c7" stroke-width="1"/>
  <text x="385" y="1764" text-anchor="middle" font-size="14" font-weight="600" fill="#0369a1">auth:4101</text>
  <rect x="480" y="1735" width="150" height="45" rx="6" fill="#fff" stroke="#0284c7" stroke-width="1"/>
  <text x="555" y="1764" text-anchor="middle" font-size="14" font-weight="600" fill="#0369a1">dash:4102</text>
  <rect x="650" y="1735" width="150" height="45" rx="6" fill="#fff" stroke="#0284c7" stroke-width="1"/>
  <text x="725" y="1764" text-anchor="middle" font-size="14" font-weight="600" fill="#0369a1">identity:4103</text>
  <rect x="140" y="1795" width="150" height="45" rx="6" fill="#fff" stroke="#0284c7" stroke-width="1"/>
  <text x="215" y="1824" text-anchor="middle" font-size="14" font-weight="600" fill="#0369a1">debts:4104</text>
  <rect x="310" y="1795" width="150" height="45" rx="6" fill="#fff" stroke="#0284c7" stroke-width="1"/>
  <text x="385" y="1824" text-anchor="middle" font-size="14" font-weight="600" fill="#0369a1">rehab:4105</text>
  <rect x="480" y="1795" width="150" height="45" rx="6" fill="#fff" stroke="#0284c7" stroke-width="1"/>
  <text x="555" y="1824" text-anchor="middle" font-size="14" font-weight="600" fill="#0369a1">help:4106</text>
  <rect x="650" y="1795" width="150" height="45" rx="6" fill="#fff" stroke="#0284c7" stroke-width="1"/>
  <text x="725" y="1824" text-anchor="middle" font-size="14" font-weight="600" fill="#0369a1">pdf:4107</text>
  <rect x="140" y="1860" width="660" height="45" rx="6" fill="#fef3c7" stroke="#d97706" stroke-width="1"/>
  <text x="470" y="1889" text-anchor="middle" font-size="14" font-weight="600" fill="#92400e">db-init (Prisma migrate) + Shared SQLite Volume</text>
  <text x="535" y="1940" text-anchor="middle" font-size="14" fill="#64748b">Container network: service discovery via container names</text>

  <!-- K8s -->
  <rect x="1010" y="1680" width="850" height="290" rx="12" fill="#ecfdf5" stroke="#059669" stroke-width="2" filter="url(#sl)"/>
  <text x="1435" y="1715" text-anchor="middle" font-size="22" font-weight="700" fill="#047857">Kubernetes Cluster</text>
  <rect x="1040" y="1735" width="340" height="45" rx="6" fill="#fff" stroke="#059669" stroke-width="1"/>
  <text x="1210" y="1764" text-anchor="middle" font-size="14" font-weight="600" fill="#047857">Namespace: finaware</text>
  <rect x="1400" y="1735" width="340" height="45" rx="6" fill="#fff" stroke="#059669" stroke-width="1"/>
  <text x="1570" y="1764" text-anchor="middle" font-size="14" font-weight="600" fill="#047857">ConfigMap: app-config</text>
  <rect x="1040" y="1795" width="340" height="45" rx="6" fill="#fff" stroke="#059669" stroke-width="1"/>
  <text x="1210" y="1824" text-anchor="middle" font-size="14" font-weight="600" fill="#047857">8 Deployments (web + 7 services)</text>
  <rect x="1400" y="1795" width="340" height="45" rx="6" fill="#fff" stroke="#059669" stroke-width="1"/>
  <text x="1570" y="1824" text-anchor="middle" font-size="14" font-weight="600" fill="#047857">8 Services (ClusterIP)</text>
  <rect x="1040" y="1855" width="340" height="45" rx="6" fill="#fff" stroke="#059669" stroke-width="1"/>
  <text x="1210" y="1884" text-anchor="middle" font-size="14" font-weight="600" fill="#047857">Ingress (routing)</text>
  <rect x="1400" y="1855" width="340" height="45" rx="6" fill="#fff" stroke="#059669" stroke-width="1"/>
  <text x="1570" y="1884" text-anchor="middle" font-size="14" font-weight="600" fill="#047857">HPA (CPU autoscale)</text>
  <rect x="1040" y="1915" width="700" height="35" rx="6" fill="#fef3c7" stroke="#d97706" stroke-width="1"/>
  <text x="1390" y="1939" text-anchor="middle" font-size="14" font-weight="600" fill="#92400e">PVC: SQLite persistent volume storage</text>

  <!-- Helm -->
  <rect x="1910" y="1680" width="950" height="290" rx="12" fill="#faf5ff" stroke="#7c3aed" stroke-width="2" filter="url(#sl)"/>
  <text x="2385" y="1715" text-anchor="middle" font-size="22" font-weight="700" fill="#6b21a8">Helm Charts (deploy/helm/finaware/)</text>
  <rect x="1940" y="1740" width="400" height="40" rx="6" fill="#fff" stroke="#7c3aed" stroke-width="1"/>
  <text x="2140" y="1766" text-anchor="middle" font-size="14" font-weight="600" fill="#6b21a8">Chart.yaml (v0.1.0)</text>
  <rect x="2370" y="1740" width="400" height="40" rx="6" fill="#fff" stroke="#7c3aed" stroke-width="1"/>
  <text x="2570" y="1766" text-anchor="middle" font-size="14" font-weight="600" fill="#6b21a8">values.yaml (defaults)</text>
  <rect x="1940" y="1800" width="260" height="40" rx="6" fill="#dcfce7" stroke="#16a34a" stroke-width="1"/>
  <text x="2070" y="1826" text-anchor="middle" font-size="14" font-weight="600" fill="#166534">values-dev.yaml</text>
  <rect x="2220" y="1800" width="260" height="40" rx="6" fill="#fef9c3" stroke="#ca8a04" stroke-width="1"/>
  <text x="2350" y="1826" text-anchor="middle" font-size="14" font-weight="600" fill="#854d0e">values-staging.yaml</text>
  <rect x="2500" y="1800" width="260" height="40" rx="6" fill="#fee2e2" stroke="#dc2626" stroke-width="1"/>
  <text x="2630" y="1826" text-anchor="middle" font-size="14" font-weight="600" fill="#991b1b">values-prod.yaml</text>
  <rect x="1940" y="1860" width="820" height="75" rx="6" fill="#fff" stroke="#7c3aed" stroke-width="1"/>
  <text x="2350" y="1892" text-anchor="middle" font-size="14" fill="#6b7280">Templates: deployment.yaml, service.yaml, ingress.yaml, microservices.yaml,</text>
  <text x="2350" y="1915" text-anchor="middle" font-size="14" fill="#6b7280">configmap.yaml, hpa.yaml, pvc.yaml, namespace.yaml</text>

  <!-- Health -->
  <rect x="80" y="2050" width="2840" height="100" rx="12" fill="#fff" fill-opacity="0.5" stroke="#94a3b8" stroke-width="1.5" filter="url(#sl)"/>
  <text x="120" y="2085" font-size="22" font-weight="700" fill="#334155">HEALTH &amp; READINESS PROBES</text>
  <text x="120" y="2118" font-size="17" fill="#374151">All 8 processes expose:</text>
  <rect x="380" y="2092" width="350" height="42" rx="8" fill="#dcfce7" stroke="#22c55e" stroke-width="1.2"/>
  <text x="555" y="2120" text-anchor="middle" font-size="16" font-weight="600" fill="#166534">GET /health/live → 200 OK</text>
  <rect x="760" y="2092" width="500" height="42" rx="8" fill="#dcfce7" stroke="#22c55e" stroke-width="1.2"/>
  <text x="1010" y="2120" text-anchor="middle" font-size="16" font-weight="600" fill="#166534">GET /health/ready → 200 (DB connected)</text>
  <text x="1330" y="2120" font-size="15" fill="#64748b">Used by K8s liveness/readiness probes for pod health management</text>

  <!-- Legend -->
  <rect x="80" y="2190" width="2840" height="100" rx="12" fill="#fff" stroke="#e2e8f0" stroke-width="1.5" filter="url(#sl)"/>
  <text x="120" y="2228" font-size="22" font-weight="700" fill="#1e293b">Legend</text>
  <line x1="120" y1="2258" x2="180" y2="2258" stroke="#3b82f6" stroke-width="3" marker-end="url(#arB)"/>
  <text x="195" y="2265" font-size="16" fill="#374151">HTTP Request</text>
  <line x1="370" y1="2258" x2="430" y2="2258" stroke="#475569" stroke-width="2" stroke-dasharray="8,4"/>
  <text x="445" y="2265" font-size="16" fill="#374151">Service Proxy</text>
  <line x1="610" y1="2258" x2="670" y2="2258" stroke="#ef4444" stroke-width="2" stroke-dasharray="6,4"/>
  <text x="685" y="2265" font-size="16" fill="#374151">DB Query</text>
  <rect x="810" y="2248" width="22" height="16" rx="4" fill="url(#sA)" stroke="#d97706" stroke-width="0.8"/>
  <text x="840" y="2263" font-size="15" fill="#374151">Auth</text>
  <rect x="910" y="2248" width="22" height="16" rx="4" fill="url(#sD)" stroke="#2563eb" stroke-width="0.8"/>
  <text x="940" y="2263" font-size="15" fill="#374151">Dashboard</text>
  <rect x="1050" y="2248" width="22" height="16" rx="4" fill="url(#sI)" stroke="#16a34a" stroke-width="0.8"/>
  <text x="1080" y="2263" font-size="15" fill="#374151">Identity</text>
  <rect x="1175" y="2248" width="22" height="16" rx="4" fill="url(#sDe)" stroke="#db2777" stroke-width="0.8"/>
  <text x="1205" y="2263" font-size="15" fill="#374151">Debts</text>
  <rect x="1290" y="2248" width="22" height="16" rx="4" fill="url(#sR)" stroke="#7c3aed" stroke-width="0.8"/>
  <text x="1320" y="2263" font-size="15" fill="#374151">Rehab</text>
  <rect x="1405" y="2248" width="22" height="16" rx="4" fill="url(#sH)" stroke="#0d9488" stroke-width="0.8"/>
  <text x="1435" y="2263" font-size="15" fill="#374151">Help</text>
  <rect x="1505" y="2248" width="22" height="16" rx="4" fill="url(#sP)" stroke="#ea580c" stroke-width="0.8"/>
  <text x="1535" y="2263" font-size="15" fill="#374151">PDF</text>
  <rect x="1600" y="2248" width="22" height="16" rx="4" fill="url(#dbGr)" stroke="#ef4444" stroke-width="0.8"/>
  <text x="1630" y="2263" font-size="15" fill="#374151">Database</text>
  <rect x="1730" y="2248" width="22" height="16" rx="4" fill="url(#exGr)" stroke="#7c3aed" stroke-width="0.8"/>
  <text x="1760" y="2263" font-size="15" fill="#374151">External</text>

  <text x="1500" y="2580" text-anchor="middle" font-size="18" fill="#94a3b8">FinAware Service Communication v1.0 — Microservices Architecture</text>
</svg>